<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-130598673-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

<title data-react-helmet="true">Redux Essentials, Part 5: Async Logic and Data Fetching | Redux</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Redux Essentials, Part 5: Async Logic and Data Fetching | Redux"><meta data-react-helmet="true" name="description" content="The official Essentials tutorial for Redux: learn how to use Redux, the right way"><meta data-react-helmet="true" property="og:description" content="The official Essentials tutorial for Redux: learn how to use Redux, the right way"><meta data-react-helmet="true" property="og:url" content="https://ko.redux.js.org/tutorials/essentials/part-5-async-logic">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico">


<link rel="stylesheet" href="/styles.a344fa58.css">


<link rel="preload" href="/styles.2b827d98.js" as="script">

<link rel="preload" href="/runtime~main.47f9c7bf.js" as="script">

<link rel="preload" href="/main.0e846de9.js" as="script">

<link rel="preload" href="/1.e9f8e4ee.js" as="script">

<link rel="preload" href="/2.a771463f.js" as="script">

<link rel="preload" href="/89.c4337676.js" as="script">

<link rel="preload" href="/ec1ed54d.85cf7297.js" as="script">

<link rel="preload" href="/17896441.6fff5cf7.js" as="script">

<link rel="preload" href="/35f94802.6a4bb912.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/redux.svg" alt="Redux Logo"><strong class="navbar__title">Redux</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction/getting-started">시작하기</a><a class="navbar__item navbar__link" href="/tutorials/essentials/part-1-overview-concepts">Tutorial</a><a class="navbar__item navbar__link" href="/api/api-reference">API</a><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/style-guide/style-guide">Best Practices</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/deminoth/redux" class="navbar__item navbar__link">GitHub</a><a class="navbar__item navbar__link" href="/introduction/getting-started#help-and-discussion">Need help?</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/redux.svg" alt="Redux Logo"><strong class="navbar__title">Redux</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="right" href="/introduction/getting-started">시작하기</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/tutorials/essentials/part-1-overview-concepts">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/api/api-reference">API</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/style-guide/style-guide">Best Practices</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/deminoth/redux" class="menu__link" position="right">GitHub</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/introduction/getting-started#help-and-discussion">Need help?</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/getting-started">Redux 시작하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/installation">설치</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/motivation">동기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/core-concepts">Core Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/three-principles">3가지 원칙</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/prior-art">기존 기술</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/learning-resources">Learning Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/ecosystem">생태계</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/examples">예제</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/tutorials-index">Tutorials Index</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Redux Essentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-1-overview-concepts">Redux Overview and Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-2-app-structure">Redux App Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-3-data-flow">Basic Redux Data Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-4-using-data">Using Redux Data</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/tutorials/essentials/part-5-async-logic">Async Logic and Data Fetching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-6-performance-normalization">Performance and Normalizing Data</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Basic Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/basic-tutorial">기초 강좌: 소개</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/actions">액션</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/reducers">리듀서</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/store">저장소</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/data-flow">데이터 흐름</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/usage-with-react">React와 함께 사용하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/basics/example">예제: Todo List</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Advanced Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/advanced-tutorial">심화 강좌: Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/async-actions">비동기 액션</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/async-flow">비동기 흐름</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/middleware">미들웨어</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/usage-with-react-router">React Router와 함께 사용하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/example-reddit-api">예제: Reddit API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/advanced/next-steps">Next Steps</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Recipes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/recipe-index">레시피 색인</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/configuring-your-store">Configuring Your Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/usage-with-typescript">Usage With TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/migrating-to-redux">Redux로 마이그레이션</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/using-object-spread-operator">객체 확산 연산자 사용하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/reducing-boilerplate">보일러플레이트 줄이기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/server-rendering">Server Rendering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/writing-tests">Writing Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/computing-derived-data">Computing Derived Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/implementing-undo-history">Implementing Undo History</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/isolating-redux-sub-apps">Isolating Redux Sub-Apps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/using-immutablejs-with-redux">Using Immutable.JS with Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/code-splitting">Code Splitting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Structuring Reducers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/structuring-reducers">리듀서 구조 잡기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/prerequisite-concepts">사전에 요구되는 개념들</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/basic-reducer-structure">기본 리듀서 구조</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/splitting-reducer-logic">리듀서 로직 분리하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/refactoring-reducer-example">리듀서 리팩토링하기 예제</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/using-combinereducers">combineReducers 사용하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/beyond-combinereducers">combineReducers 더 알아보기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/normalizing-state-shape">상태 정규화하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/updating-normalized-data">정규화된 데이터 업데이트하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/reusing-reducer-logic">리듀서 로직 재사용하기</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/immutable-update-patterns">불변 업데이트 패턴</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/initializing-state">상태 초기화하기</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq">FAQ 색인</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/general">General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/reducers">Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/organizing-state">Organizing State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/store-setup">Store Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/actions">Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/immutable-data">Immutable Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/code-structure">Code Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/performance">Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/design-decisions">Design Decisions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/react-redux">React Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/miscellaneous">Miscellaneous</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Style Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/style-guide/style-guide">Style Guide: Best Practices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/glossary">용어집</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/troubleshooting">문제해결</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/api-reference">API 레퍼런스</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/createstore">createStore</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/combinereducers">combineReducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/applymiddleware">applyMiddleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/bindactioncreators">bindActionCreators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/compose">compose</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/overview">Redux Toolkit: Overview</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="redux-essentials-part-5-async-logic-and-data-fetching"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#redux-essentials-part-5-async-logic-and-data-fetching" title="Direct link to heading">#</a>Redux Essentials, Part 5: Async Logic and Data Fetching</h1><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>What You&#x27;ll Learn</h5></div><div class="admonition-content"><ul><li>How to use the Redux &quot;thunk&quot; middleware for async logic</li><li>Patterns for handling async request state</li><li>How to use the Redux Toolkit <code>createAsyncThunk</code> API to simplify async calls</li></ul></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Prerequisites</h5></div><div class="admonition-content"><ul><li>Familiarity with using AJAX requests to fetch and update data from a server</li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="introduction"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#introduction" title="Direct link to heading">#</a>Introduction</h2><p>In <a href="/tutorials/essentials/part-4-using-data">Part 4: Using Redux Data</a>, we saw how to use multiple pieces of data from the Redux store inside of React components, customize the contents of action objects before they&#x27;re dispatched, and handle more complex update logic in our reducers.</p><p>So far, all the data we&#x27;ve worked with has been directly inside of our React client application. However, most real applications need to work with data from a server, by making HTTP API calls to fetch and save items.</p><p>In this section, we&#x27;ll convert our social media app to fetch the posts and users data from an API, and add new posts by saving them to the API.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="example-rest-api-and-client"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#example-rest-api-and-client" title="Direct link to heading">#</a>Example REST API and Client</h3><p>To keep the example project isolated but realistic, the initial project setup already included a fake in-memory REST API for our data (configured using <a href="https://miragejs.com/">the Mirage.js mock API tool</a>). The API uses <code>/fakeApi</code> as the base URL for the endpoints, and supports the typical <code>GET/POST/PUT/DELETE</code> HTTP methods for <code>/fakeApi/posts</code>, <code>/fakeApi/users</code>, and <code>fakeApi/notifications</code>. It&#x27;s defined in <code>src/api/server.js</code>.</p><p>The project also includes a small HTTP API client object that exposes <code>client.get()</code> and <code>client.post()</code> methods, similar to popular HTTP libraries like <code>axios</code>. It&#x27;s defined in <code>src/api/client.js</code>.</p><p>We&#x27;ll use the <code>client</code> object to make HTTP calls to our in-memory fake REST API for this section.</p><p>Also, the mock server has been set up to reuse the same random seed each time the page is loaded, so that it will generate the same list of fake users and fake posts. If you want to reset that, delete the <code>&#x27;randomTimestampSeed&#x27;</code> value in your browser&#x27;s Local Storage and reload the page, or you can turn that off by editing <code>src/api/server.js</code> and setting <code>useSeededRNG</code> to <code>false</code>.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>As a reminder, the code examples focus on the key concepts and changes for each section. See the CodeSandbox projects and the <a href="https://github.com/reduxjs/redux-essentials-example-app/tree/tutorial-steps"><code>tutorial-steps</code> branch in the project repo</a> for the complete changes in the application.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="thunks-and-async-logic"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#thunks-and-async-logic" title="Direct link to heading">#</a>Thunks and Async Logic</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-middleware-to-enable-async-logic"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-middleware-to-enable-async-logic" title="Direct link to heading">#</a>Using Middleware to Enable Async Logic</h3><p>By itself, a Redux store doesn&#x27;t know anything about async logic. It only knows how to synchronously dispatch actions, update the state by calling the root reducer function, and notify the UI that something has changed. Any asynchronicity has to happen outside the store.</p><p>But, what if you want to have async logic interact with the store by dispatching or checking the current store state? That&#x27;s where <a href="/advanced/middleware">Redux middleware</a> come in. They extend the store, and allow you to:</p><ul><li>Execute extra logic when any action is dispatched (such as logging the action and state)</li><li>Pause, modify, delay, replace, or halt dispatched actions</li><li>Write extra code that has access to <code>dispatch</code> and <code>getState</code></li><li>Teach <code>dispatch</code> how to accept other values besides plain action objects, such as functions and promises, by intercepting them and dispatching real action objects instead</li></ul><p><a href="/faq/actions#how-can-i-represent-side-effects-such-as-ajax-calls-why-do-we-need-things-like-action-creators-thunks-and-middleware-to-do-async-behavior">The most common reason to use middleware is to allow different kinds of async logic to interact with the store</a>. This allows you to write code that can dispatch actions and check the store state, while keeping that logic separate from your UI.</p><p>There are many kinds of async middleware for Redux, and each lets you write your logic using different syntax. The most common async middleware is <a href="https://github.com/reduxjs/redux-thunk"><code>redux-thunk</code></a>, which lets you write plain functions that may contain async logic directly. Redux Toolkit&#x27;s <code>configureStore</code> function <a href="https://redux-toolkit.js.org/api/getDefaultMiddleware#included-default-middleware">automatically sets up the thunk middleware by default</a>, and <a href="/style-guide/style-guide#use-thunks-for-async-logic">we recommend using thunks as the standard approach for writing async logic with Redux</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="thunk-functions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#thunk-functions" title="Direct link to heading">#</a>Thunk Functions</h3><p>Once the thunk middleware has been added to the Redux store, it allows you to pass <em>thunk functions</em> directly to <code>store.dispatch</code>. A thunk function will always be called with <code>(dispatch, getState)</code> as its arguments, and you can use them inside the thunk as needed.</p><p>Thunks typically dispatch plain actions using action creators, like <code>dispatch(increment())</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> store </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">configureStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> reducer</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> counterReducer </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">exampleThunkFunction</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateBefore </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter before: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateBefore</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">increment</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateAfter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter after: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateAfter</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">exampleThunkFunction</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>For consistency with dispatching normal action objects, we typically write these as <em>thunk action creators</em>, which return the thunk function. These action creators can take arguments that can be used inside the thunk.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">logAndAdd</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">amount</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateBefore </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter before: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateBefore</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">incrementByAmount</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateAfter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter after: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateAfter</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">logAndAdd</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token number" style="color:#AE81FF">5</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>Thunks are typically written in &quot;slice&quot; files. <code>createSlice</code> itself does not have any special support for defining thunks, so you should write them as separate functions in the same slice file. That way, they have access to the plain action creators for that slice, and it&#x27;s easy to find where the thunk lives.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="writing-async-thunks"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#writing-async-thunks" title="Direct link to heading">#</a>Writing Async Thunks</h3><p>Thunks may have async logic inside of them, such as <code>setTimeout</code>, <code>Promise</code>s, and <code>async/await</code>. This makes them a good place to put AJAX calls to a server API.</p><p>Data fetching logic for Redux typically follows a predictable pattern:</p><ul><li>A &quot;start&quot; action is dispatched before the request, to indicate that the request is in progress. This may be used to track loading state to allow skipping duplicate requests or show loading indicators in the UI.</li><li>The async request is made</li><li>Depending on the request result, the async logic dispatches either a &quot;success&quot; action containing the result data, or a &quot;failure&quot; action containing error details. The reducer logic clears the loading state in both cases, and either processes the result data from the success case, or stores the error value for potential display.</li></ul><p>These steps are not <em>required</em>, but are commonly used. (If all you care about is a successful result, you can just dispatch a single &quot;success&quot; action when the request finishes, and skip the &quot;start&quot; and &quot;failure&quot; actions.)</p><p>Redux Toolkit provides a <code>createAsyncThunk</code> API to implement the creation and dispatching of these actions, and we&#x27;ll look at how to use it shortly.</p><details class="detailed-explanation"><summary><h4>Detailed Explanation: Dispatching Request Status Actions in Thunks</h4></summary><p>If we were to write out the code for a typical async thunk by hand, it might look like this:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsStarted</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;repoDetails/fetchStarted&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsSuccess</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">repoDetails</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;repoDetails/fetchSucceeded&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  payload</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> repoDetails</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsFailed</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;repoDetails/fetchFailed&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">fetchIssuesCount</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">org</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> repo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token parameter">dispatch</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsStarted</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> repoDetails </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getRepoDetails</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsSuccess</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">repoDetails</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsFailed</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toString</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>However, writing code using this approach is tedious. Each separate type of request needs repeated similar implementation:</p><ul><li>Unique action types need to be defined for the three different cases</li><li>Each of those action types usually has a corresponding action creator function</li><li>A thunk has to be written that dispatches the correct actions in the right sequence</li></ul><p><code>createAsyncThunk</code> abstracts this pattern by generating the action types and action creators, and generating a thunk that dispatches those actions automatically. You provide a callback function that makes the async call and returns a Promise with the result.</p></details><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="loading-posts"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#loading-posts" title="Direct link to heading">#</a>Loading Posts</h2><p>So far, our <code>postsSlice</code> has used some hardcoded sample data as its initial state. We&#x27;re going to switch that to start with an empty array of posts instead, and then fetch a list of posts from the server.</p><p>In order to do that, we&#x27;re going to have to change the structure of the state in our <code>postsSlice</code>, so that we can keep track of the current state of the API request.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="extracting-posts-selectors"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#extracting-posts-selectors" title="Direct link to heading">#</a>Extracting Posts Selectors</h3><p>Right now, the <code>postsSlice</code> state is a single array of <code>posts</code>. We need to change that to be an object that has the <code>posts</code> array, plus the loading state fields.</p><p>Meanwhile, the UI components like <code>&lt;PostsList&gt;</code> are trying to read posts from <code>state.posts</code> in their <code>useSelector</code> hooks, assuming that that field is an array. We need to change those locations also to match the new data.</p><p>It would be nice if we didn&#x27;t have to keep rewriting our components every time we made a change to the data format in our reducers. One way to avoid this is to define reusable selector functions in the slice files, and have the components use those selectors to extract the data they need instead of repeating the selector logic in each component. That way, if we do change our state structure again, we only need to update the code in the slice file.</p><p>The <code>&lt;PostsList&gt;</code> component needs to read a list of all the posts, and the <code>&lt;SinglePostPage&gt;</code> and <code>&lt;EditPostForm&gt;</code> components need to look up a single post by its ID. Let&#x27;s export two small selector functions from <code>postsSlice.js</code> to cover those cases:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/postsSlice.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token comment" style="color:#778090">/* omit slice code*/</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postAdded</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postUpdated</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reactionAdded </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllPosts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectPostById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>Note that the <code>state</code> parameter for these selector functions is the root Redux state object, as it was for the inlined anonymous selectors we wrote directly inside of <code>useSelector</code>.</p><p>We can then use them in the components:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/PostsList.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> selectAllPosts </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// omit component contents</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/EditPostForm.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> selectPostById </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">SinglePostPage</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> post </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectPostById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// omit component logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>It&#x27;s often a good idea to encapsulate data lookups by writing reusable selectors. You can also create &quot;memoized&quot; selectors that can help improve performance, which we&#x27;ll look at in a later part of this tutorial.</p><p>But, like any abstraction, it&#x27;s not something you should do <em>all</em> the time, everywhere. Writing selectors means more code to understand and maintain. <strong>Don&#x27;t feel like you need to write selectors for every single field of your state</strong>. Try starting without any selectors, and add some later when you find yourself looking up the same values in many parts of your application code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="loading-state-for-requests"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#loading-state-for-requests" title="Direct link to heading">#</a>Loading State for Requests</h3><p>When we make an API call, we can view its progress as a small state machine that can be in one of four possible states:</p><ul><li>The request hasn&#x27;t started yet</li><li>The request is in progress</li><li>The request succeeded, and we now have the data we need</li><li>The request failed, and there&#x27;s probably an error message</li></ul><p>We <em>could</em> track that information using some booleans, like <code>isLoading: true</code>, but it&#x27;s better to track these states as a single enum value. A good pattern for this is to have a state section that looks like:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token builtin" style="color:#a6e22e">string</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>These fields would exist alongside whatever actual data is being stored. These specific string state names aren&#x27;t required - feel free to use other names if you want, like <code>&#x27;pending&#x27;</code> instead of <code>&#x27;loading&#x27;</code>, or <code>&#x27;complete&#x27;</code> instead of <code>&#x27;succeeded&#x27;</code>.</p><p>We can use this information to decide what to show in our UI as the request progresses, and also add logic in our reducers to prevent cases like loading data twice.</p><p>Let&#x27;s update our <code>postsSlice</code> to use this pattern to track loading state for a &quot;fetch posts&quot; request. We&#x27;ll switch our state from being an array of posts by itself, to look like <code>{posts, status, error}</code>. We&#x27;ll also remove the old sample post entries from our initial state. As part of this change, we also need to change any uses of <code>state</code> as an array to be <code>state.posts</code> instead, because the array is now one level deeper:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/postsSlice.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> nanoid </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  posts</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    postAdded</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">prepare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">title</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> content</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token comment" style="color:#778090">// omit prepare logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reaction </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reactions</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">reaction</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">title</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> title</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">content</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> content</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postAdded</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postUpdated</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reactionAdded </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllPosts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectPostById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>Yes, this <em>does</em> mean that we now have a nested object path that looks like <code>state.posts.posts</code>, which is somewhat repetitive and silly :) We <em>could</em> change the nested array name to be <code>items</code> or <code>data</code> or something if we wanted to avoid that, but we&#x27;ll leave it as-is for now.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="fetching-data-with-createasyncthunk"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#fetching-data-with-createasyncthunk" title="Direct link to heading">#</a>Fetching Data with <code>createAsyncThunk</code></h3><p>Redux Toolkit&#x27;s <code>createAsyncThunk</code> API generates thunks that automatically dispatch those &quot;start/success/failure&quot; actions for you.</p><p>Let&#x27;s start by adding a thunk that will make an AJAX call to retrieve a list of posts. We&#x27;ll import the <code>client</code> utility from the <code>src/api</code> folder, and use that to make a request to <code>&#x27;/fakeApi/posts&#x27;</code>.</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/postsSlice</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> nanoid</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> createAsyncThunk </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> client </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  posts</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;posts/fetchPosts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p><code>createAsyncThunk</code> accepts two arguments:</p><ul><li>A string that will be used as the prefix for the generated action types</li><li>A &quot;payload creator&quot; callback function that should return a <code>Promise</code> containing some data, or a rejected <code>Promise</code> with an error</li></ul><p>The payload creator will usually make an AJAX call of some kind, and can either return the <code>Promise</code> from the AJAX call directly, or extract some data from the API response and return that. We typically write this using the JS <code>async/await</code> syntax, which lets us write functions that use <code>Promise</code>s while using standard <code>try/catch</code> logic instead of <code>somePromise.then()</code> chains.</p><p>In this case, we pass in <code>&#x27;posts/fetchPosts&#x27;</code> as the action type prefix. Our payload creation callback waits for the API call to return a response. The response object looks like <code>{posts: []}</code>, and we want our dispatched Redux action to have a payload that is <em>just</em> the array of posts. So, we extract <code>response.posts</code>, and return that from the callback.</p><p>If we try calling <code>dispatch(fetchPosts())</code>, the <code>fetchPosts</code> thunk will first dispatch an action type of <code>&#x27;posts/fetchPosts/pending&#x27;</code>:</p><p><img src="/img/tutorials/essentials/devtools-posts-pending.png" alt="`createAsyncThunk`: posts pending action"></p><p>We can listen for this action in our reducer and mark the request status as <code>&#x27;loading&#x27;</code>.</p><p>Once the <code>Promise</code> resolves, the <code>fetchPosts</code> thunk takes the <code>response.posts</code> array we returned from the callback, and dispatches a <code>posts/fetchPosts/fulfilled&#x27;</code> action containing the posts array as <code>action.payload</code>:</p><p><img src="/img/tutorials/essentials/devtools-posts-fulfilled.png" alt="`createAsyncThunk`: posts pending action"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="dispatching-thunks-from-components"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#dispatching-thunks-from-components" title="Direct link to heading">#</a>Dispatching Thunks from Components</h4><p>So, let&#x27;s update our <code>&lt;PostsList&gt;</code> component to actually fetch this data automatically for us.</p><p>We&#x27;ll import the <code>fetchPosts</code> thunk into the component. Like all of our other action creators, we have to dispatch it, so we&#x27;ll also need to add the <code>useDispatch</code> hook. Since we want to fetch this data when <code>&lt;PostsList&gt;</code> mounts, we need to import the React <code>useEffect</code> hook:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/PostsList.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useEffect </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useSelector</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> useDispatch </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#778090">// omit other imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> fetchPosts </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postStatus </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">useEffect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">postStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>It&#x27;s important that we only try to fetch the list of posts once. If we do it every time the <code>&lt;PostsList&gt;</code> component renders, or is re-created because we&#x27;ve switched between views, we might end up fetching the posts several times. We can use the <code>posts.status</code> enum to help decide if we need to actually start fetching, by selecting that into the component and only starting the fetch if the status is <code>&#x27;idle&#x27;</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="reducers-and-loading-actions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reducers-and-loading-actions" title="Direct link to heading">#</a>Reducers and Loading Actions</h4><p>Next up, we need to handle both these actions in our reducers. This requires a bit deeper look at the <code>createSlice</code> API we&#x27;ve been using.</p><p>We&#x27;ve already seen that <code>createSlice</code> will generate an action creator for every reducer function we define in the <code>reducers</code> field, and that the generated action types include the name of the slice, like:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;123&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> title</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;First Post&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;Some text here&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#778090">/*</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">  type: &#x27;posts/postUpdated&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">  payload: {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">    id: &#x27;123&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">    title: &#x27;First Post&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">    content: &#x27;Some text here&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">*/</span></div></div></div></div></div><p>However, there are times when a slice reducer needs to respond to <em>other</em> actions that weren&#x27;t defined as part of this slice&#x27;s <code>reducers</code> field. We can do that using the slice <code>extraReducers</code> field instead.</p><details class="detailed-explanation"><summary><h4>Detailed Explanation: Adding Extra Reducers to Slices</h4></summary><p>The keys in the <code>extraReducers</code> object should be Redux action type strings, like <code>&#x27;counter/increment&#x27;</code>. We <em>could</em> write those by hand ourselves, although we&#x27;d have to quote the keys if they contain any characters like &#x27;/&#x27;:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#a6e22e">&#x27;counter/increment&#x27;</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#778090">// normal reducer logic to update the posts slice</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>However, action creators generated by Redux Toolkit automatically return their action type string if you call <code>actionCreator.toString()</code>. This means we can pass them as ES6 object literal computed properties, and the action types will become the keys of the object:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> increment </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> object </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">object</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#778090">// { &quot;counter/increment&quot;: Function}</span></div></div></div></div></div><p>This works for the <code>extraReducers</code> field:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> increment </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#778090">// normal reducer logic to update the posts slice</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>We can also add extra reducers by using the &quot;builder callback&quot; syntax for <code>extraReducers</code>. If we pass a function for <code>extraReducers</code> instead of an object, we can use the <code>builder</code> parameter to add individual cases. The <code>builder.addCase()</code> function takes either a plain string action type to listen for, or a Redux Toolkit action creator:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> increment </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token parameter">builder</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    builder</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">addCase</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;counter/decrement&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    builder</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">addCase</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>If you&#x27;re using TypeScript, you should use the builder callback form of <code>extraReducers</code>.</p></details><p>In this case, we need to listen for the &quot;pending&quot; and &quot;fulfilled&quot; action types dispatched by our <code>fetchPosts</code> thunk. Those action creators are attached to our actual <code>fetchPost</code> function, and we can pass those to <code>extraReducers</code> to listen for those actions:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;posts/fetchPosts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// omit existing reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">pending</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#778090">// Add any fetched posts to the array</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">concat</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">rejected</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">message</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>We&#x27;ll handle all three action types that could be dispatched by the thunk, based on the <code>Promise</code> we returned:</p><ul><li>When the request starts, we&#x27;ll set the <code>status</code> enum to <code>&#x27;loading&#x27;</code></li><li>If the request succeeds, we mark the <code>status</code> as <code>&#x27;succeeded&#x27;</code>, and add the fetched posts to <code>state.posts</code></li><li>If the request fails, we&#x27;ll mark the <code>status</code> as <code>&#x27;failed&#x27;</code>, and save any error message into the state so we can display it</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="displaying-loading-state"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#displaying-loading-state" title="Direct link to heading">#</a>Displaying Loading State</h3><p>Our <code>&lt;PostsList&gt;</code> component is already checking for any updates to the posts that are stored in Redux, and rerendering itself any time that list changes. So, if we refresh the page, we should see a random set of posts from our fake API show up on screen:</p><p>The fake API we&#x27;re using returns data immediately. However, a real API call will probably take some time to return a response. It&#x27;s usually a good idea to show some kind of &quot;loading...&quot; indicator in the UI so the user knows we&#x27;re waiting for data.</p><p>We can update our <code>&lt;PostsList&gt;</code> to show a different bit of UI based on the <code>state.posts.status</code> enum: a spinner if we&#x27;re loading, an error message if it failed, or the actual posts list if we have the data. The result might look like this:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/PostsList.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postStatus </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> error </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">useEffect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">postStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> content</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;loader&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Loading</span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// Sort posts in reverse chronological order by datetime string</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> orderedPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> posts</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">slice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">sort</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> orderedPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">PostExcerpt</span><span class="token plain"> key</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> post</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">post</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">error</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">section className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;posts-list&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Posts</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">content</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">section</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>But, the fake API call is still returning almost immediately, so we can barely see the loading spinner right now. If you want to force the fake API call to take longer, you can open up <code>api/server.js</code>, and uncomment this line:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">api/server.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">//this.timing = 2000</span></div></div></div></div></div><p>Uncommenting that line will force the fake API to wait 2 seconds before responding. Feel free to turn that on and off as we go if you want to see how the UI shows our loading spinner.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="loading-users"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#loading-users" title="Direct link to heading">#</a>Loading Users</h2><p>We&#x27;re now fetching and displaying our list of posts. But, if we look at the posts, there&#x27;s a problem: they all now say &quot;Unknown User&quot; as the authors:</p><p><img src="/img/tutorials/essentials/posts-unknownAuthor.png" alt="Unknown post authors"></p><p>This is because the post entries are being randomly generated by the fake API server, which also randomly generates a set of fake users every time we reload the page. We need to update our users slice to fetch those users when the application starts.</p><p>Like last time, we&#x27;ll create another async thunk to get the users from the API and return them, then handle the <code>fulfilled</code> action in the <code>extraReducers</code> slice field. We&#x27;ll skip worrying about loading state for now:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/users/usersSlice.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> createAsyncThunk </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> client </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchUsers </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;users/fetchUsers&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> usersSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchUsers</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> usersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></div></div></div></div><p>We only need to fetch the list of users once, and we want to do it right when the application starts. We can do that in our <code>index.js</code> file, and directly dispatch the <code>fetchUsers</code> thunk because we have the <code>store</code> right there:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">index.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090">// omit imports</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> fetchUsers </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./features/users/usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./api/server&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchUsers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token maybe-class-name">ReactDOM</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">render</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access maybe-class-name">StrictMode</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Provider</span><span class="token plain"> store</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Provider</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access maybe-class-name">StrictMode</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token dom variable" style="color:#F8F8F2">document</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getElementById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;root&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>Now, each of the posts should be showing a username again, and we should also have that same list of users shown in the &quot;Author&quot; dropdown in our <code>&lt;AddPostForm&gt;</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="adding-new-posts"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-new-posts" title="Direct link to heading">#</a>Adding New Posts</h2><p>We have one more step for this section. When we add a new post from the <code>&lt;AddPostForm&gt;</code>, that post is only getting added to the Redux store inside our app. We need to actually make an API call that will create the new post entry in our fake API server instead, so that it&#x27;s &quot;saved&quot;. (Since this is a fake API, the new post won&#x27;t persist if we reload the page, but if we had a real backend server it would be available next time we reload.)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="sending-data-with-thunks"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#sending-data-with-thunks" title="Direct link to heading">#</a>Sending Data with Thunks</h3><p>We can use <code>createAsyncThunk</code> to help with sending data, not just fetching it. We&#x27;ll create a thunk that accepts the values from our <code>&lt;AddPostForm&gt;</code> as an argument, and makes an HTTP POST call to the fake API to save the data.</p><p>In the process, we&#x27;re going to change how we work with the new post object in our reducers. Currently, our <code>postsSlice</code> is creating a new post object in the <code>prepare</code> callback for <code>postAdded</code>, and generating a new unique ID for that post. In most apps that save data to a server, the server will take care of generating unique IDs and filling out any extra fields, and will usually return the completed data in its response. So, we can send a request body like <code>{ title, content, user: userId }</code> to the server, and then take the complete post object it sends back and add it to our <code>postsSlice</code> state.</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/postsSlice.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> addNewPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token string" style="color:#a6e22e">&#x27;posts/addNewPost&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// The payload creator receives the partial `{title, content, user}` object</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token parameter">initialPost</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// We send the initial data to the fake API server</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">post</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> post</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> initialPost </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// The response includes the complete post object, including unique ID</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">post</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// The existing `postAdded` reducer and prepare callback were deleted</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token comment" style="color:#778090">// omit logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token comment" style="color:#778090">// omit logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#778090">// omit posts loading reducers</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#778090">// We can directly add the new post object to our posts array</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="checking-thunk-results-in-components"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#checking-thunk-results-in-components" title="Direct link to heading">#</a>Checking Thunk Results in Components</h3><p>Finally, we&#x27;ll update <code>&lt;AddPostForm&gt;</code> to dispatch the <code>addNewPost</code> thunk instead the old <code>postUpdated</code> action. Since this is another API call to the server, it will take some time and <em>could</em> fail. The <code>addNewPost()</code> thunk will automatically dispatch its <code>pending/fulfilled/rejected</code> actions to the Redux store, which we&#x27;re already handling. We <em>could</em> track the request status in <code>postsSlice</code> using a second loading enum if we wanted to, but for this example let&#x27;s keep the loading state tracking limited to the component.</p><p>It would be good if we can at least disable the &quot;Save Post&quot; button while we&#x27;re waiting for the request, so the user can&#x27;t accidentally try to save a post twice. If the request fails, we might also want to show an error message here in the form, or perhaps just log it to the console.</p><p>We can have our component logic wait for the async thunk to finish, and check the result when it&#x27;s done:</p><div class="mdxCodeBlock_iHAB"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_U1PS">features/posts/AddPostForm.js</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useDispatch</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> useSelector </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> unwrapResult </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addNewPost </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">AddPostForm</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setTitle</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setContent</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">userId</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setUserId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">addRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// omit useSelectors and change handlers</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> canSave </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">every</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token known-class-name class-name">Boolean</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&amp;&amp;</span><span class="token plain"> addRequestStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">onSavePostClicked</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">canSave</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;pending&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> resultAction </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">await</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> user</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> userId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">unwrapResult</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">resultAction</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setTitle</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setContent</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setUserId</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Failed to save the post: &#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">finally</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#778090">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>We can add a loading status enum field as a React <code>useState</code> hook, similar to how we&#x27;re tracking loading state in <code>postsSlice</code> for fetching posts. In this case, we just want to know if the request is in progress or not.</p><p>When we call <code>dispatch(addNewPost())</code>, the async thunk returns a <code>Promise</code> from <code>dispatch</code>. We can <code>await</code> that promise here to know when the thunk has finished its request. But, we don&#x27;t yet know if that request succeeded or failed.</p><p><code>createAsyncThunk</code> handles any errors internally, so that we don&#x27;t see any messages about &quot;rejected Promises&quot; in our logs. It then returns the final action it dispatched: either the <code>fulfilled</code> action if it succeeded, or the <code>rejected</code> action if it failed. Redux Toolkit has a utility function called <code>unwrapResult</code> that will return either the actual <code>action.payload</code> value from a <code>fulfilled</code> action, or throw an error if it&#x27;s the <code>rejected</code> action. This lets us handle success and failure in the component using normal <code>try/catch</code> logic. So, we&#x27;ll clear out the input fields to reset the form if the post was successfully created, and log the error to the console if it failed.</p><p>If you want to see what happens when the <code>addNewPost</code> API call fails, try creating a new post where the &quot;Content&quot; field only has the word &quot;error&quot; (without quotes). The server will see that and send back a failed response, so you should see a message logged to the console.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-youve-learned"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-youve-learned" title="Direct link to heading">#</a>What You&#x27;ve Learned</h2><p>Async logic and data fetching are always a complex topic. As you&#x27;ve seen, Redux Toolkit includes some tools to automate the typical Redux data fetching patterns.</p><p>Here&#x27;s what our app looks like now that we&#x27;re fetching data from that fake API:</p><iframe class="codesandbox" src="https://codesandbox.io/embed/github/reduxjs/redux-essentials-example-app/tree/checkpoint-3-postRequests/?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="redux-essentials-example-app" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><p>As a reminder, here&#x27;s what we covered in this section:</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li><strong>You can write reusable &quot;selector&quot; functions to encapsulate reading values from the Redux state</strong><ul><li>Selectors are functions that get the Redux <code>state</code> as an argument, and return some data</li></ul></li><li><strong>Redux uses plugins called &quot;middleware&quot; to enable async logic</strong><ul><li>The standard async middleware is called <code>redux-thunk</code>, which is included in Redux Toolkit</li><li>Thunk functions receive <code>dispatch</code> and <code>getState</code> as arguments, and can use those as part of async logic</li></ul></li><li><strong>You can dispatch additional actions to help track the loading status of an API call</strong><ul><li>The typical pattern is dispatching a &quot;pending&quot; action before the call, then either a &quot;success&quot; containing the data or a &quot;failure&quot; action containing the error</li><li>Loading state should usually be stored as an enum, like <code>&#x27;idle&#x27; | &#x27;loading&#x27; | &#x27;succeeded&#x27; | &#x27;failed&#x27;</code></li></ul></li><li><strong>Redux Toolkit has a <code>createAsyncThunk</code> API that dispatches these actions for you</strong><ul><li><code>createAsyncThunk</code> accepts a &quot;payload creator&quot; callback that should return a <code>Promise</code>, and generates <code>pending/fulfilled/rejected</code> action types automatically</li><li>Generated action creators like <code>fetchPosts</code> dispatch those actions based on the <code>Promise</code> you return</li><li>You can listen for these action types in <code>createSlice</code> using the <code>extraReducers</code> field, and update the state in reducers based on those actions.</li><li>Action creators can be used to automatically fill in the keys of the <code>extraReducers</code> object so the slice knows what actions to listen for.</li></ul></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="whats-next"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#whats-next" title="Direct link to heading">#</a>What&#x27;s Next?</h2><p>We&#x27;ve got one more set of topics to cover for this tutorial. In <a href="/tutorials/essentials/part-6-performance-normalization">Part 6: Performance and Normalizing Data</a>, we&#x27;ll look at how Redux usage affects React performance, and some ways we can optimize our application for improved performance.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tutorials/essentials/part-4-using-data"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Redux Essentials, Part 4: Using Redux Data</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/tutorials/essentials/part-6-performance-normalization"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Redux Essentials, Part 6: Performance and Normalizing Data »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#introduction" class="contents__link">Introduction</a><ul><li><a href="#example-rest-api-and-client" class="contents__link">Example REST API and Client</a></li></ul></li><li><a href="#thunks-and-async-logic" class="contents__link">Thunks and Async Logic</a><ul><li><a href="#using-middleware-to-enable-async-logic" class="contents__link">Using Middleware to Enable Async Logic</a></li><li><a href="#thunk-functions" class="contents__link">Thunk Functions</a></li><li><a href="#writing-async-thunks" class="contents__link">Writing Async Thunks</a></li></ul></li><li><a href="#loading-posts" class="contents__link">Loading Posts</a><ul><li><a href="#extracting-posts-selectors" class="contents__link">Extracting Posts Selectors</a></li><li><a href="#loading-state-for-requests" class="contents__link">Loading State for Requests</a></li><li><a href="#fetching-data-with-createasyncthunk" class="contents__link">Fetching Data with <code>createAsyncThunk</code></a></li><li><a href="#displaying-loading-state" class="contents__link">Displaying Loading State</a></li></ul></li><li><a href="#loading-users" class="contents__link">Loading Users</a></li><li><a href="#adding-new-posts" class="contents__link">Adding New Posts</a><ul><li><a href="#sending-data-with-thunks" class="contents__link">Sending Data with Thunks</a></li><li><a href="#checking-thunk-results-in-components" class="contents__link">Checking Thunk Results in Components</a></li></ul></li><li><a href="#what-youve-learned" class="contents__link">What You&#39;ve Learned</a></li><li><a href="#whats-next" class="contents__link">What&#39;s Next?</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started">시작하기</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/essentials/part-1-overview-concepts">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/basics/basic-tutorial">강좌</a></li><li class="footer__item"><a class="footer__link-item" href="/api/api-reference">API 레퍼런스</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="http://stackoverflow.com/questions/tagged/redux">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started#help-and-discussion">Feedback</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/deminoth/redux">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Redux Logo" src="/img/redux.svg"></a></div><div>Copyright © 2015–2020 Dan Abramov and the Redux documentation authors.</div></div></div></footer>
</div>

<script src="/styles.2b827d98.js"></script>

<script src="/runtime~main.47f9c7bf.js"></script>

<script src="/main.0e846de9.js"></script>

<script src="/1.e9f8e4ee.js"></script>

<script src="/2.a771463f.js"></script>

<script src="/89.c4337676.js"></script>

<script src="/ec1ed54d.85cf7297.js"></script>

<script src="/17896441.6fff5cf7.js"></script>

<script src="/35f94802.6a4bb912.js"></script>


</body>
</html>